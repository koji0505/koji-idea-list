# こーじの思い付きリスト - アプリケーション仕様書

**バージョン**: 2.0
**最終更新日**: 2025年12月14日
**作成者**: Claude (Anthropic)

---

## 📋 目次

1. [プロジェクト概要](#プロジェクト概要)
2. [システム構成](#システム構成)
3. [技術スタック](#技術スタック)
4. [機能仕様](#機能仕様)
5. [データベース設計](#データベース設計)
6. [画面仕様](#画面仕様)
7. [デプロイ環境](#デプロイ環境)
8. [開発環境](#開発環境)
9. [セットアップ手順](#セットアップ手順)
10. [今後の拡張案](#今後の拡張案)

---

## 🎯 プロジェクト概要

### 目的
個人のアイデアを効率的に管理・整理するためのWebアプリケーション及びモバイルアプリケーション。

### 主な特徴
- クラウドベースのデータ管理（Supabase）
- Web/Mobile両対応のマルチプラットフォーム
- TypeScriptによる型安全な開発
- リアルタイムデータ同期対応

---

## 🏗️ システム構成

```
┌─────────────────────────────────────────────┐
│           ユーザー（デバイス）              │
├──────────────────┬──────────────────────────┤
│   Webブラウザ    │    スマートフォン        │
│   (Vercel)       │   (Expo Go/実機)         │
└────────┬─────────┴──────────┬───────────────┘
         │                    │
         │   HTTPS/REST API   │
         │                    │
         └────────┬───────────┘
                  │
         ┌────────▼─────────┐
         │    Supabase      │
         │  (PostgreSQL)    │
         │  - データ管理    │
         │  - 認証(将来)    │
         └──────────────────┘
```

### アーキテクチャの変遷

**旧構成（v1.0）**:
- Backend: Node.js + Express + SQLite
- Frontend: React (Web), React Native (Mobile)

**新構成（v2.0）** ← 現在:
- Backend: **削除**（Supabase直接接続）
- Database: PostgreSQL (Supabase)
- Frontend: React (Web), React Native + TypeScript (Mobile)

---

## 🛠️ 技術スタック

### フロントエンド（Web）
| 技術 | バージョン | 用途 |
|------|-----------|------|
| React | 18.2.0 | UIフレームワーク |
| JavaScript | ES6+ | プログラミング言語 |
| CSS3 | - | スタイリング |
| axios | - | HTTP通信（削除予定） |
| @supabase/supabase-js | latest | Supabaseクライアント |

### フロントエンド（Mobile）
| 技術 | バージョン | 用途 |
|------|-----------|------|
| React Native | 0.81.5 | モバイルフレームワーク |
| TypeScript | 5.9.2 | プログラミング言語 |
| Expo | ~54.0.29 | 開発プラットフォーム |
| React Navigation | 7.x | ナビゲーション |
| @supabase/supabase-js | latest | Supabaseクライアント |

### バックエンド・データベース
| 技術 | バージョン | 用途 |
|------|-----------|------|
| Supabase | Cloud | BaaS（Backend as a Service） |
| PostgreSQL | 15+ | リレーショナルデータベース |

### デプロイ・インフラ
| サービス | 用途 |
|---------|------|
| Vercel | Webアプリホスティング |
| Supabase | データベース・API |

---

## ⚙️ 機能仕様

### 1. アイデア管理機能

#### 1.1 アイデア一覧表示
- **機能概要**: 登録されたアイデアを一覧表示
- **表示項目**:
  - カテゴリーバッジ
  - タイトル
  - 詳細（プレビュー、2行まで）
  - レベルバッジ（高・中・低）
  - 登録日時
- **ソート順**: 登録日時の降順（新しい順）
- **対応画面**: Web/Mobile

#### 1.2 アイデア詳細表示
- **機能概要**: アイデアの全情報を表示
- **表示項目**:
  - カテゴリー
  - タイトル
  - 詳細内容（全文）
  - レベル
  - 登録日時（年/月/日 時:分）
- **アクション**:
  - 編集ボタン → 編集画面へ遷移
  - 削除ボタン → 削除確認ダイアログ表示
- **対応画面**: Web（モーダル）/Mobile（専用画面）

#### 1.3 アイデア新規作成
- **機能概要**: 新しいアイデアを登録
- **入力項目**:
  - カテゴリー（必須、テキスト入力）
  - タイトル（必須、テキスト入力）
  - レベル（必須、選択：高・中・低）
  - 詳細内容（任意、複数行テキスト）
- **バリデーション**:
  - カテゴリーとタイトルは必須
  - 空白のみの入力は不可
- **対応画面**: Web（モーダル）/Mobile（専用画面）

#### 1.4 アイデア編集
- **機能概要**: 既存のアイデアを編集
- **入力項目**: 新規作成と同じ
- **初期値**: 既存データを表示
- **対応画面**: Web（モーダル）/Mobile（専用画面）

#### 1.5 アイデア削除
- **機能概要**: アイデアを削除
- **確認ダイアログ**: 「本当に削除しますか？」
- **削除後**: 一覧画面に戻る
- **対応画面**: Web/Mobile

### 2. フィルタリング機能

#### 2.1 カテゴリーフィルター
- **機能概要**: カテゴリーでアイデアを絞り込み
- **選択肢**: 「すべて」+ 登録済みカテゴリー
- **UI**:
  - Web: ドロップダウン
  - Mobile: カスタムドロップダウン（モーダル選択）
- **動作**: 選択時に即座にフィルタリング実行

#### 2.2 レベルフィルター
- **機能概要**: レベルでアイデアを絞り込み
- **選択肢**: すべて / 高 / 中 / 低
- **UI**: カテゴリーフィルターと同じ
- **動作**: 選択時に即座にフィルタリング実行

#### 2.3 複合フィルター
- **機能概要**: カテゴリーとレベルを同時に適用
- **動作**: AND条件で絞り込み

### 3. UI/UX機能

#### 3.1 レスポンシブデザイン
- **Web**: デスクトップ/タブレット/スマートフォン対応
- **Mobile**: iOS/Android両対応

#### 3.2 リアルタイム更新
- **機能**: 引っ張って更新（Pull to Refresh）
- **対応**: Mobileアプリ

#### 3.3 ローディング表示
- **表示タイミング**: データ取得中
- **UI**: スピナー表示

#### 3.4 エラーハンドリング
- **ネットワークエラー**: アラート表示
- **データ取得失敗**: エラーメッセージ表示
- **バリデーションエラー**: 入力フォーム近くに表示

---

## 💾 データベース設計

### テーブル構成

#### ideas テーブル
| カラム名 | データ型 | 制約 | 説明 |
|---------|---------|------|------|
| id | BIGSERIAL | PRIMARY KEY | アイデアID（自動採番） |
| category | TEXT | NOT NULL | カテゴリー |
| title | TEXT | NOT NULL | タイトル |
| details | TEXT | NULL | 詳細内容 |
| level | TEXT | NOT NULL, CHECK | レベル（'高', '中', '低'） |
| created_at | TIMESTAMPTZ | DEFAULT NOW() | 登録日時 |

#### インデックス
```sql
CREATE INDEX idx_ideas_category ON ideas(category);
CREATE INDEX idx_ideas_level ON ideas(level);
CREATE INDEX idx_ideas_created_at ON ideas(created_at DESC);
```

#### ビュー: categories
```sql
CREATE OR REPLACE VIEW categories AS
  SELECT DISTINCT category
  FROM ideas
  ORDER BY category;
```

### Row Level Security (RLS)
- **読み取り**: 全ユーザー許可
- **挿入**: 全ユーザー許可
- **更新**: 全ユーザー許可
- **削除**: 全ユーザー許可

**注**: 将来的には認証を実装し、ユーザーごとのデータ分離を推奨

---

## 🖼️ 画面仕様

### Web版

#### ホーム画面
```
┌──────────────────────────────────────┐
│  こーじの思い付きリスト              │ ← ヘッダー
├──────────────────────────────────────┤
│ カテゴリー: [すべて ▼]              │
│ レベル:     [すべて ▼]              │ ← フィルター
├──────────────────────────────────────┤
│  ＋ 新しいアイデアを追加              │ ← 追加ボタン
├──────────────────────────────────────┤
│ ┌────────────────────────────────┐   │
│ │ [技術]              [高]      │   │
│ │ React Hooksの学習              │   │
│ │ useEffectとuseContextを...    │   │ ← アイデアカード
│ │ 2025/12/10                    │   │
│ │ [編集] [削除]                  │   │
│ └────────────────────────────────┘   │
│ ...                                  │
└──────────────────────────────────────┘
```

#### 詳細画面（モーダル）
```
┌──────────────────────────────────────┐
│  詳細                            [×] │ ← モーダルヘッダー
├──────────────────────────────────────┤
│ カテゴリー: 技術                     │
│ レベル:     高                       │
│ タイトル:   React Hooksの学習        │
│                                      │
│ 詳細内容:                            │
│ useEffectとuseContextを深く理解する  │
│                                      │
│ 登録日: 2025/12/10 15:30             │
├──────────────────────────────────────┤
│          [編集]    [削除]            │ ← アクションボタン
└──────────────────────────────────────┘
```

### Mobile版

#### ホーム画面
```
┌──────────────────────────────────────┐
│ ← こーじの思い付きリスト             │ ← ヘッダー
├──────────────────────────────────────┤
│ カテゴリー:                          │
│ [すべて              ▼]             │ ← カスタムドロップダウン
│                                      │
│ レベル:                              │
│ [すべて              ▼]             │
├──────────────────────────────────────┤
│  ＋ 新しいアイデアを追加              │
├──────────────────────────────────────┤
│ ┌────────────────────────────────┐   │
│ │ [技術]              [高]      │   │
│ │ React Hooksの学習              │   │
│ │ useEffectとuseContextを...    │   │
│ │ 2025/12/10                    │   │
│ │ [編集] [削除]                  │   │
│ └────────────────────────────────┘   │
└──────────────────────────────────────┘
```

### カラースキーム

#### レベルバッジ
- **高**: `#e74c3c` (赤)
- **中**: `#f39c12` (オレンジ)
- **低**: `#3498db` (青)

#### メインカラー
- **プライマリ**: `#4a90e2` (青)
- **成功**: `#4caf50` (緑)
- **危険**: `#e74c3c` (赤)
- **背景**: `#f5f5f5` (ライトグレー)

---

## 🚀 デプロイ環境

### Web（本番環境）
- **ホスティング**: Vercel
- **URL**: https://koji-idea-list-ihpdpsaqe-ksagawa0505s-projects.vercel.app
- **デプロイ方法**:
  ```bash
  cd web
  vercel --prod
  ```
- **自動デプロイ**: 未設定（手動デプロイ）

### Mobile（開発環境）
- **プラットフォーム**: Expo Go
- **対応OS**: iOS 13+, Android 5.0+
- **配布方法**: QRコードスキャン（開発版）
- **本番配布**: 未実装（将来的にEAS Buildを推奨）

### データベース
- **サービス**: Supabase
- **プロジェクトURL**: https://winfhqanryfixmhffihu.supabase.co
- **リージョン**: 自動選択

---

## 💻 開発環境

### 必要なソフトウェア
- **Node.js**: v16.0.0以上
- **npm**: v8.0.0以上
- **Git**: 最新版
- **Vercel CLI**: `npm install -g vercel`

### 推奨エディタ
- **Visual Studio Code**
- **推奨拡張機能**:
  - ESLint
  - Prettier
  - TypeScript and JavaScript Language Features

---

## 📝 セットアップ手順

### 初回セットアップ

#### 1. リポジトリのクローン
```bash
cd "C:\c_works\random idea list"
```

#### 2. 依存関係のインストール
```cmd
setup.bat
```

または、個別にインストール:
```bash
# Webアプリ
cd web
npm install

# Mobileアプリ
cd ../mobile
npm install
```

#### 3. 環境変数の設定

**web/.env**:
```env
REACT_APP_SUPABASE_URL=https://winfhqanryfixmhffihu.supabase.co
REACT_APP_SUPABASE_ANON_KEY=your-anon-key-here
```

**mobile/.env**:
```env
EXPO_PUBLIC_SUPABASE_URL=https://winfhqanryfixmhffihu.supabase.co
EXPO_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
```

⚠️ **重要**: `.env`ファイルは`.gitignore`に含まれています。Gitにコミットしないでください。

### ローカル開発

#### Webアプリの起動
```cmd
start-web.bat
```
または:
```bash
cd web
npm start
```
→ http://localhost:3000 で起動

#### Mobileアプリの起動
```cmd
start-mobile.bat
```
または:
```bash
cd mobile
npx expo start --clear
```
→ QRコードをスキャンしてExpo Goで開く

### Vercelへのデプロイ

#### 初回デプロイ
```bash
cd web
vercel
```

#### 本番環境へのデプロイ
```bash
vercel --prod
```

#### 環境変数の追加
```bash
vercel env add REACT_APP_SUPABASE_URL
vercel env add REACT_APP_SUPABASE_ANON_KEY
```

---

## 🔮 今後の拡張案

### Phase 1: 認証機能
- [ ] Supabase Authを使用したユーザー認証
- [ ] ユーザーごとのデータ分離
- [ ] ログイン/ログアウト機能

### Phase 2: 高度な機能
- [ ] タグ機能（複数タグの追加）
- [ ] 検索機能（タイトル・詳細での全文検索）
- [ ] 並び替え機能（タイトル順、レベル順など）
- [ ] お気に入り機能

### Phase 3: コラボレーション
- [ ] アイデアの共有機能
- [ ] コメント機能
- [ ] いいね機能

### Phase 4: データ分析
- [ ] アイデアの統計表示
- [ ] カテゴリー別グラフ
- [ ] 月次レポート

### Phase 5: エクスポート
- [ ] CSV/JSON形式でのエクスポート
- [ ] PDF形式でのエクスポート
- [ ] 印刷機能

### Phase 6: プッシュ通知
- [ ] 定期リマインダー
- [ ] アイデア登録の通知

### Phase 7: モバイル本番配布
- [ ] EAS Buildによるビルド
- [ ] App Store配布
- [ ] Google Play配布

---

## 📚 参考資料

### 公式ドキュメント
- [React Documentation](https://react.dev/)
- [React Native Documentation](https://reactnative.dev/)
- [Expo Documentation](https://docs.expo.dev/)
- [Supabase Documentation](https://supabase.com/docs)
- [Vercel Documentation](https://vercel.com/docs)
- [TypeScript Documentation](https://www.typescriptlang.org/docs/)

### プロジェクト内ドキュメント
- `README.md` - プロジェクト概要
- `TROUBLESHOOTING.md` - トラブルシューティング
- `参考用_README.md` (backend/, database/) - 旧アーキテクチャの参考資料

---

## 📞 サポート・問い合わせ

### 開発者
- **名前**: こーじ
- **プロジェクト**: こーじの思い付きリスト

### トラブルシューティング
- プロジェクト内の`TROUBLESHOOTING.md`を参照
- Vercelのビルドログを確認
- Supabaseのログを確認

---

## 📄 変更履歴

### v2.0 (2025/12/14)
- ✅ TypeScript移行完了
- ✅ Supabase移行完了
- ✅ Vercelデプロイ完了
- ✅ バックエンド削除
- ✅ iOS/Androidドロップダウン改善
- ✅ 仕様書作成

### v1.0 (2025/12/10)
- ✅ 初期リリース
- ✅ Web/Mobileアプリ作成
- ✅ SQLiteデータベース実装
- ✅ バックエンドAPI実装

---

**本仕様書は、プロジェクトの進化に合わせて随時更新されます。**
